language: rust

rust: nightly

os:
  - linux
  - macos

addons:
  apt:
    sources:
      - sourceline: 'deb [arch=amd64] http://storage.googleapis.com/bazel-apt stable jdk1.8'
        key_url: 'https://bazel.build/bazel-release.pub.gpg'
    packages:
      - bazel
  homebrew:
    taps: bazelbuild/tap
    casks: bazel

install:
  - cargo install cargo-raze

script:
  - cargo run --manifest-path demo-rs/Cargo.toml
  - cargo test
  - pushd tests/bazel_integration/cargo && ./update.sh && popd
